<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <title>å¸å®‰Alphaç©ºæŠ•å®æ—¶æŸ¥è¯¢</title>
  <link rel="icon" href="https://www.binance.com/favicon.ico" />
  <style>
    body {
      font-family: "Segoe UI", "PingFang SC", "Microsoft YaHei", sans-serif;
      background: #f9f9f9;
      color: #333;
      max-width: 900px;
      margin: 40px auto;
      padding: 20px;
    }
    h2 { text-align: center; margin-bottom: 20px; }
    h3 { text-align: center; color: #444; margin-top: 30px; }

    .control, .link-buttons {
      text-align: center;
      margin-bottom: 20px;
    }

    button {
      padding: 8px 16px;
      font-size: 15px;
      background-color: #0078d4;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      transition: background-color 0.2s;
    }
    button:hover { background-color: #005fa3; }

    select {
      padding: 6px 10px;
      font-size: 15px;
      margin-left: 10px;
    }

    .link-buttons a {
      display: inline-block;
      margin: 6px;
      padding: 8px 16px;
      border-radius: 6px;
      border: 1px solid #0078d4;
      background: white;
      color: #0078d4;
      text-decoration: none;
      font-size: 14px;
      transition: all 0.2s ease;
    }
    .link-buttons a:hover {
      background-color: #0078d4;
      color: white;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      background: #fff;
      box-shadow: 0 2px 5px rgba(0,0,0,0.05);
      border-radius: 8px;
      overflow: hidden;
    }
    th, td {
      border: 1px solid #ddd;
      padding: 12px;
      text-align: center;
      vertical-align: middle;
    }
    th {
      background-color: #f2f2f2;
      font-weight: bold;
    }
    tr:hover { background-color: #f9fcff; }

    .subtext {
      font-size: 13px;
      color: #777;
      margin-top: 4px;
    }

    #lastUpdate, #author {
      text-align: center;
      margin-top: 16px;
      color: #777;
      font-size: 14px;
      opacity: 0.8;
    }

    #progressBlock, #surplusBlock, #merlDeadline {
      text-align: center;
      margin-top: 20px;
    }

    #progressBarContainer {
      width: 80%;
      margin: 0 auto;
      background: #eee;
      border-radius: 6px;
      overflow: hidden;
      height: 16px;
    }

    #progressBar {
      height: 100%;
      width: 0%;
      background: linear-gradient(to right, #0078d4, #00c6ff);
      transition: width 0.5s;
    }

    .discount-note {
      font-size: 13px;
      color: #888;
      margin-top: 5px;
    }

    #merlDeadline {
      color: #e55353;
      font-size: 15px;
      display: none;
    }

    #countdownBar {
      width: 80%;
      height: 8px;
      background: #ffe4e4;
      border-radius: 6px;
      overflow: hidden;
      margin: 6px auto 0;
      display: none;
    }

    #countdownBarInner {
      height: 100%;
      width: 100%;
      background-color: #e55353;
      transition: width 1s;
    }
  </style>
</head>
<body>
  <h2>å¸å®‰ Alphaç©ºæŠ•å®æ—¶æ•°æ®å±•ç¤º</h2>

  <div class="control">
    <button id="refreshBtn" onclick="refreshData()">ğŸ”„ åˆ·æ–°æ•°æ®</button>
    <select id="tokenSelect" onchange="refreshData()">
      <option value="MERL" selected>MERL</option>
      <option value="XTER">XTER</option>
    </select>
  </div>

  <div class="link-buttons">
    <a href="https://debank.com/profile/0x73D8bD54F7Cf5FAb43fE4Ef40A62D390644946Db" target="_blank">ğŸ“¦ å¸å®‰Alpha åˆ†å‘ç©ºæŠ•åœ°å€ä¼ é€é—¨</a>
    <a href="https://bscscan.com/address/0x497f4521d79925989ae304c7caf84ed57988e88a" target="_blank">ğŸ“œ å¸å®‰ Web3 IDO éƒ¨ç½²åˆçº¦åœ°å€ä¼ é€é—¨</a>
  </div>

  <h3>ğŸ“Š ç©ºæŠ•å‘æ”¾è¿›åº¦</h3>
  <table>
    <thead>
      <tr>
        <th>ä»£å¸åç§°</th>
        <th>å½“å‰ä»·æ ¼ (USDT)</th>
        <th>æ€»ç©ºæŠ•æ•°é‡</th>
        <th>æœªé¢†å–æ•°é‡</th>
        <th>å·²é¢†å–æ•°é‡</th>
        <th>å·²é¢†å–ç”¨æˆ·</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td id="tokenName">-</td>
        <td><div id="priceUsd">-</div></td>
        <td><div id="totalSupply">-</div><div class="subtext" id="totalValue">( - USD )</div></td>
        <td><div id="unclaimed">-</div><div class="subtext" id="unclaimedValue">( - USD )</div></td>
        <td><div id="claimedAmount">-</div><div class="subtext" id="claimedValue">( - USD )</div></td>
        <td id="claimedUsers">-</td>
      </tr>
    </tbody>
  </table>

  <div id="progressBlock">
    <p>ğŸ“ˆ å·²é¢†å–è¿›åº¦ï¼š<span id="claimedPercent">-</span>%</p>
    <div id="progressBarContainer"><div id="progressBar"></div></div>
  </div>

  <h3>ğŸ“Œ å‰©ä½™é¢†å–ä¿¡æ¯</h3>
  <div id="surplusBlock">
    <p>å‰©ä½™å¯åˆ†ä»£å¸ï¼š<span id="surplusToken">-</span> æš</p>
    <p>å¯¹åº”ä»·å€¼ï¼š<span id="surplusValue">-</span></p>
    <p class="discount-note">* ä¸Šè¿°æ•°æ®å·²é»˜è®¤æŒ‰ 85% æ˜¾ç¤ºï¼Œä¿å®ˆä¼°ç®—ï¼Œä»…ä¾›å‚è€ƒ</p>
  </div>

  <h3>â³ MERL é¢†å–æˆªæ­¢</h3>
  <div id="merlDeadline">
    MERL é¢†å–æˆªæ­¢æ—¶é—´ï¼š2025 å¹´ 5 æœˆ 21 æ—¥ 17:00ï¼ˆä¸œå…«åŒºï¼‰<br>
    å‰©ä½™æ—¶é—´ï¼š<span id="countdown">åŠ è½½ä¸­...</span>
  </div>
  <div id="countdownBar"><div id="countdownBarInner"></div></div>
  <div id="lastUpdate">ğŸ“… ä¸Šæ¬¡æ›´æ–°äº --:--:--</div>
  <div id="author">ğŸ‘¤ ä½œè€…ï¼š<a href="https://x.com/0xXIAOc" target="_blank" style="color:#0078d4;">@0xXIAOc</a></div>

  <script>
    const TOKENS = {
      MERL: {
        name: "MERL",
        contract: "0xa0c56a8c0692bd10b3fa8f8ba79cf5332b7107f9",
        totalSupply: 31364000,
        perUserAmount: 1000,
        fetchUserCountFromAPI: true
      },
      XTER: {
        name: "XTER",
        contract: "0x103071da56e7cd95b415320760d6a0ddc4da1ca5",
        totalSupply: 9967366,
        perUserAmount: 294,
        claimedUsers: 18942,
        fetchUserCountFromAPI: false
      }
    };

    let currentPrice = 0;
    let countdownTimer = null;

    function formatInt(n) {
      return Math.floor(Number(n)).toLocaleString();
    }

    function formatPrice(n) {
      return Number(n).toFixed(4) + " USD";
    }

    function formatValue(n) {
      return Math.floor(Number(n)).toLocaleString() + " USD";
    }

    function updateTimestamp() {
      const now = new Date();
      const h = String(now.getHours()).padStart(2, '0');
      const m = String(now.getMinutes()).padStart(2, '0');
      const s = String(now.getSeconds()).padStart(2, '0');
      document.getElementById("lastUpdate").innerText = `ğŸ“… ä¸Šæ¬¡æ›´æ–°äº ${h}:${m}:${s}`;
    }

    async function fetchPrice(contract) {
      try {
        const res = await fetch(`https://api.dexscreener.com/latest/dex/search/?q=${contract}`);
        const data = await res.json();
        const price = data.pairs[0]?.priceUsd;
        currentPrice = price ? parseFloat(price) : 0;
        document.getElementById("priceUsd").innerText = currentPrice > 0 ? formatPrice(currentPrice) : "æœªæ‰¾åˆ°ä»·æ ¼";
      } catch {
        currentPrice = 0;
        document.getElementById("priceUsd").innerText = "è·å–å¤±è´¥";
      }
    }

    async function queryClaimedData(token) {
      let claimedUsers = 0;

      if (token.fetchUserCountFromAPI) {
        try {
          const res = await fetch("https://lingquss.vercel.app/api/proxy");
          const json = await res.json();
          claimedUsers = Number(json?.sold_count) || 0;
        } catch {
          claimedUsers = 0;
        }
      } else {
        claimedUsers = token.claimedUsers;
      }

      const claimedAmount = claimedUsers * token.perUserAmount;
      const unclaimed = token.totalSupply - claimedAmount;
      const claimedPercent = ((claimedAmount / token.totalSupply) * 100).toFixed(2);
      const surplusPerUser = claimedUsers > 0 ? (unclaimed / claimedUsers) : 0;

      const rawValue = surplusPerUser * currentPrice;
      const adjustedToken = surplusPerUser * 0.85;
      const adjustedValue = rawValue * 0.85;

      document.getElementById("tokenName").innerText = token.name;
      document.getElementById("totalSupply").innerText = formatInt(token.totalSupply);
      document.getElementById("claimedUsers").innerText = formatInt(claimedUsers);
      document.getElementById("claimedAmount").innerText = formatInt(claimedAmount);
      document.getElementById("unclaimed").innerText = formatInt(unclaimed);

      document.getElementById("totalValue").innerText = `( ${formatValue(token.totalSupply * currentPrice)} )`;
      document.getElementById("unclaimedValue").innerText = `( ${formatValue(unclaimed * currentPrice)} )`;
      document.getElementById("claimedValue").innerText = `( ${formatValue(claimedAmount * currentPrice)} )`;

      document.getElementById("claimedPercent").innerText = claimedPercent;
      document.getElementById("progressBar").style.width = `${claimedPercent}%`;

      document.getElementById("surplusToken").innerText = adjustedToken.toFixed(3);
      document.getElementById("surplusValue").innerText = formatValue(adjustedValue);

      updateTimestamp();
    }

    function startCountdown() {
      const endTime = new Date("2025-05-21T17:00:00+08:00").getTime();
      const totalTime = endTime - new Date("2025-05-20T17:00:00+08:00").getTime(); // 24h
      if (countdownTimer) clearInterval(countdownTimer);

      countdownTimer = setInterval(() => {
        const now = new Date().getTime();
        const diff = endTime - now;

        const bar = document.getElementById("countdownBar");
        const barInner = document.getElementById("countdownBarInner");
        bar.style.display = "block";

        if (diff <= 0) {
          document.getElementById("countdown").innerText = "å·²ç»“æŸ";
          barInner.style.width = "0%";
          clearInterval(countdownTimer);
          return;
        }

        const hours = Math.floor(diff / (1000 * 60 * 60));
        const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
        const seconds = Math.floor((diff % (1000 * 60)) / 1000);
        document.getElementById("countdown").innerText =
          `${hours}å°æ—¶ ${minutes}åˆ† ${seconds}ç§’`;

        const progress = ((totalTime - diff) / totalTime) * 100;
        barInner.style.width = `${progress.toFixed(1)}%`;
      }, 1000);
    }

    async function refreshData() {
      const btn = document.getElementById("refreshBtn");
      btn.disabled = true;
      btn.innerText = "â³ åŠ è½½ä¸­...";

      const selected = document.getElementById("tokenSelect").value;
      const token = TOKENS[selected];

      await fetchPrice(token.contract);
      await queryClaimedData(token);

      const deadlineNotice = document.getElementById("merlDeadline");
      const countdownBar = document.getElementById("countdownBar");
      if (selected === "MERL") {
        deadlineNotice.style.display = "block";
        countdownBar.style.display = "block";
        startCountdown();
      } else {
        deadlineNotice.style.display = "none";
        countdownBar.style.display = "none";
        if (countdownTimer) clearInterval(countdownTimer);
      }

      btn.disabled = false;
      btn.innerText = "ğŸ”„ åˆ·æ–°æ•°æ®";
    }

    window.onload = () => {
      refreshData();
    };
  </script>
</body>
</html>
